# eClipLint Environment Variables
# Copy this file to .env and fill in your values
# IMPORTANT: Never commit .env to git (already in .gitignore)

# ============================================================================
# OpenRouter API Configuration (Cloud Mode)
# ============================================================================

# Get your API key from: https://openrouter.ai/keys
# REQUIRED for cloud mode (--cloud or ⌘⇧G hotkey)
OPENROUTER_API_KEY=

# Optional: Override default model
# Default: anthropic/claude-4.5-sonnet:beta (for complex code)
#          openai/gpt-4o (for standard repairs)
#          deepseek/deepseek-coder-v3 (for simple/cheap repairs)
# ECLIPLINT_CLOUD_MODEL=anthropic/claude-4.5-sonnet:beta

# Optional: Override fallback model
# ECLIPLINT_CLOUD_FALLBACK=openai/gpt-4o

# ============================================================================
# Local Mode Configuration (Default)
# ============================================================================

# Local mode uses mlx-lm (no API key needed)
# Models are downloaded automatically on first run

# Optional: Override default local model
# Default: mlx-community/Qwen2.5-Coder-7B-Instruct-4bit
# ECLIPLINT_LOCAL_MODEL=mlx-community/Qwen2.5-Coder-7B-Instruct-4bit

# ============================================================================
# Learning System Configuration
# ============================================================================

# Enable/disable learning from repairs (cloud mode only)
# Default: true
# ECLIPLINT_ENABLE_LEARNING=true

# Storage path for learned patterns
# Default: ~/.ecliplint/learned_patterns/
# ECLIPLINT_LEARNING_PATH=~/.ecliplint/learned_patterns/

# Max patterns per language (LRU eviction)
# Default: 1000
# ECLIPLINT_MAX_PATTERNS=1000

# ============================================================================
# Cost Management (Cloud Mode)
# ============================================================================

# Warn when monthly cost exceeds this amount (USD)
# Default: 10.0
# ECLIPLINT_WARN_AT_MONTHLY_USD=10.0

# Hard limit: Stop when monthly cost exceeds this amount (USD)
# Default: 50.0
# ECLIPLINT_MAX_MONTHLY_USD=50.0

# Hard limit: Reject repairs costing more than this (USD)
# Default: 0.50
# ECLIPLINT_MAX_PER_REPAIR_USD=0.50

# ============================================================================
# General Settings
# ============================================================================

# Default mode when no flag specified
# Options: local, cloud
# Default: local
# ECLIPLINT_MODE=local

# Enable debug logging
# Default: false
# ECLIPLINT_DEBUG=false

# Log file path
# Default: ~/.ecliplint/debug.log
# ECLIPLINT_LOG_FILE=~/.ecliplint/debug.log

# ============================================================================
# Example Configuration (Uncomment and modify as needed)
# ============================================================================

# OpenRouter API key (REQUIRED for cloud mode)
# OPENROUTER_API_KEY=sk-or-v1-1234567890abcdef1234567890abcdef1234567890abcdef1234567890abcdef

# Use Claude 4.5 Sonnet for all cloud repairs (skip complexity-based selection)
# ECLIPLINT_CLOUD_MODEL=anthropic/claude-4.5-sonnet:beta

# Enable learning from cloud repairs
# ECLIPLINT_ENABLE_LEARNING=true

# Limit monthly cloud costs to $15
# ECLIPLINT_WARN_AT_MONTHLY_USD=10.0
# ECLIPLINT_MAX_MONTHLY_USD=15.0

# Use local mode by default (cloud mode requires explicit --cloud flag)
# ECLIPLINT_MODE=local

# ============================================================================
# Security Notes
# ============================================================================

# 1. NEVER commit .env to git
#    - Already in .gitignore
#    - Check: git status (should not show .env)

# 2. API Key Security
#    - Keep OPENROUTER_API_KEY secret
#    - Don't share .env file
#    - Rotate key if compromised: https://openrouter.ai/keys

# 3. Cloud Mode Privacy
#    - Cloud mode sends code to OpenRouter API
#    - Only use for NON-PROPRIETARY code
#    - Use local mode (⌘⇧F) for proprietary code
#    - Cloud mode has different hotkey (⌘⇧G) for intentional choice

# 4. Learning System Privacy
#    - Stores abstract patterns, NOT actual code
#    - Uses SHA-256 hashing for deduplication
#    - Automatically excludes secrets (passwords, API keys, tokens)
#    - All data stored locally (~/.ecliplint/learned_patterns/)

# ============================================================================
# Quick Start
# ============================================================================

# 1. Get OpenRouter API key: https://openrouter.ai/keys

# 2. Copy this file to .env:
#    cp .env.example .env

# 3. Edit .env and add your API key:
#    OPENROUTER_API_KEY=sk-or-v1-...

# 4. Enable cloud mode:
#    ecliplint --enable-cloud

# 5. Test cloud mode:
#    echo "def foo(x=1 y=2" | pbcopy
#    ecliplint --cloud
#    pbpaste  # → def foo(x=1, y=2):

# 6. Set up hotkeys (see HOTKEY_SETUP.md):
#    ⌘⇧F - Local mode (private)
#    ⌘⇧G - Cloud mode (powerful + learning)

# ============================================================================
# Cost Estimation
# ============================================================================

# Typical usage costs (cloud mode):
#
# Light usage (50 repairs/month):
#   - Avg cost: ~$0.03/repair
#   - Monthly: ~$1.50 USD
#
# Medium usage (200 repairs/month):
#   - Avg cost: ~$0.03/repair
#   - Monthly: ~$6.00 USD
#
# Heavy usage (500 repairs/month):
#   - Avg cost: ~$0.03/repair
#   - Monthly: ~$15.00 USD
#
# Cost varies by model:
#   - DeepSeek Coder V3: ~$0.01/repair (cheap)
#   - GPT-4o: ~$0.03/repair (medium)
#   - Claude 4.5 Sonnet: ~$0.06/repair (expensive, high quality)
#
# Complexity-based selection optimizes cost automatically.
#
# Check usage: ecliplint --cloud-usage

# ============================================================================
# Troubleshooting
# ============================================================================

# Error: "OpenRouter API key not found"
# → Set OPENROUTER_API_KEY in .env

# Error: "Unauthorized" or "Invalid API key"
# → Check API key is correct: https://openrouter.ai/keys
# → Ensure no extra spaces in .env file

# Error: "Monthly cost limit exceeded"
# → Increase ECLIPLINT_MAX_MONTHLY_USD
# → Or wait until next month (resets automatically)

# Cloud mode not working
# → Check cloud enabled: ecliplint --status
# → Enable: ecliplint --enable-cloud
# → Test connection: ecliplint --test-cloud

# Learning system not working
# → Check ECLIPLINT_ENABLE_LEARNING=true
# → Check storage path exists: ls ~/.ecliplint/learned_patterns/
# → View stats: ecliplint --learning-stats

# ============================================================================
# Support
# ============================================================================

# Documentation: https://github.com/deesatzed/eClipLint
# Issues: https://github.com/deesatzed/eClipLint/issues
# OpenRouter Docs: https://openrouter.ai/docs
